<!DOCTYPE html>
<html lang="ja"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <link href="kirakira_javascript_files/bootstrap.css" rel="stylesheet">
        <link href="kirakira_javascript_files/codemirror.css" rel="stylesheet">
        <link href="kirakira_javascript_files/style.css" rel="stylesheet">
    </head>

    <body>
        <div class="navbar navbar-fixed-top navbar-inverse" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://web.sfc.keio.ac.jp/%7Et09145to/kirakira_javascript/index.html">Kirakira Javascript</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                    </ul>
                </div><!-- /.nav-collapse -->
            </div><!-- /.container -->
        </div>
        <div class="container">
            <div class="row section">
                <div class="btn-group">
                    <button type="button" class="btn btn-default" id="execute">実行</button>
                    <button type="button" class="btn btn-default" id="stop">停止</button>
                    <button type="button" class="btn btn-default" id="sample1">サンプル1</button>
                    <button type="button" class="btn btn-default" id="sample2">サンプル2</button>
                </div>
            </div>
            <div class="row section">
                <div class="col-md-6">
                    <h3>変換前</h3>
                    <textarea style="display: none;" id="code" name="code"></textarea><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 27px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" wrap="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none; font-size: 4px;"></textarea></div><div style="left: 23px;" class="CodeMirror-hscrollbar"><div style="height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 23px; min-height: 260px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1; display: none;"></div><div style="" class="CodeMirror-code"><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">1</div></div><pre>var a = "A";</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">2</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">3</div></div><pre>a = 1;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">4</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">5</div></div><pre>if(a &gt; 0) {</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">6</div></div><pre>    a = a + 1;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">7</div></div><pre>} else {</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">8</div></div><pre>    a = a - 1;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">9</div></div><pre>}</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">10</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">11</div></div><pre>for(var i = 0; i &lt; 5; i++) {</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">12</div></div><pre>    a = a + 1;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">13</div></div><pre>}</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">14</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">15</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">16</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">17</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">18</div></div><pre>&nbsp;</pre></div></div><div style="left: 4px; top: 0px; height: 14px;" class="CodeMirror-cursor">&nbsp;</div><div style="display: none;" class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 260px;"></div><div style="height: 300px;" class="CodeMirror-gutters"><div style="width: 22px;" class="CodeMirror-gutter CodeMirror-linenumbers"></div></div></div></div>
                </div>
                <div class="col-md-6">
                    <h3>変換後</h3>
                    <textarea style="display: none;" id="compiled" name="compiled"></textarea><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 27px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" wrap="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none; font-size: 4px;"></textarea></div><div style="left: 23px;" class="CodeMirror-hscrollbar"><div style="height: 1px; width: 0px;"></div></div><div style="display: block; bottom: 0px;" class="CodeMirror-vscrollbar"><div style="width: 1px; height: 414px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 23px; min-height: 414px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1; display: none;"></div><div style="" class="CodeMirror-code"><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">1</div></div><pre>var a = "A";;queue.push({ type: 'Var', symbol: 'a' });queue.push({ type: 'Assign', symbol: 'a', value_type: 'String', value: 'A' });;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">2</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">3</div></div><pre>a = 1;queue.push({ type: 'Assign', symbol: 'a', value_type: 'Number', value: 1 });;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">4</div></div><pre>queue.push({ type: 'If'});</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">5</div></div><pre>if(queue.push({ type: 'Condition', value: 'a &gt; 0' }) &amp;&amp; a &gt; 0) {queue.push({ type: 'ConditionResult', value: 'TRUE' }); </pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">6</div></div><pre>    a = a + 1;queue.push({ type: 'Assign', symbol: 'a', value_type: 'Binary', value: 'a + 1' });;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">7</div></div><pre>} else {queue.push({ type: 'ConditionResult', value: 'FALSE' }); </pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">8</div></div><pre>    a = a - 1;queue.push({ type: 'Assign', symbol: 'a', value_type: 'Binary', value: 'a - 1' });;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">9</div></div><pre>}queue.push({ type: 'EndIf' });</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">10</div></div><pre>queue.push({ type: 'For' });</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">11</div></div><pre>for(var i = 0; i &lt; 5; i++) {queue.push({ type: 'ForLoopStart' });</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">12</div></div><pre>    a = a + 1;queue.push({ type: 'Assign', symbol: 'a', value_type: 'Binary', value: 'a + 1' });;queue.push({ type: 'ForLoopEnd' });</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">13</div></div><pre>}queue.push({ type: 'EndFor' });</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">14</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">15</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">16</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">17</div></div><pre>&nbsp;</pre></div><div style="position: relative;"><div style="position: absolute; left: -23px;"><div style="left: 0px; width: 14px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">18</div></div><pre>&nbsp;</pre></div></div><div style="left: 4px; top: 0px; height: 14.5px;" class="CodeMirror-cursor">&nbsp;</div><div style="display: none;" class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 414px;"></div><div style="height: 414px;" class="CodeMirror-gutters"><div style="width: 22px;" class="CodeMirror-gutter CodeMirror-linenumbers"></div></div></div></div>
                </div>
            </div>
            <div class="row section">
                <div class="col-md-12">
                    <h3>生成データ</h3>
                    <textarea style="display: none;" id="data" name="data"></textarea><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 128px; left: 209px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" wrap="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none; font-size: 4px;"></textarea></div><div style="left: 30px;" class="CodeMirror-hscrollbar"><div style="height: 1px; width: 0px;"></div></div><div style="display: block; bottom: 0px;" class="CodeMirror-vscrollbar"><div style="width: 1px; height: 1464px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 30px; min-height: 1464px;" class="CodeMirror-sizer"><div style="position: relative; top: 980px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1; display: none;"><div style="position: absolute; left: 4px; top: 0px; width: 891px;" class="CodeMirror-selected"></div><div style="position: absolute; left: 4px; top: 462px; width: 7px; height: 14px;" class="CodeMirror-selected"></div><div style="position: absolute; left: 4px; top: 0px; width: 891px; height: 462px;" class="CodeMirror-selected"></div></div><div style="" class="CodeMirror-code"><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">71</div></div><pre>        "value_type": "Binary",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">72</div></div><pre>        "value": "a + 1"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">73</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">74</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">75</div></div><pre>        "type": "ForLoopEnd"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">76</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">77</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">78</div></div><pre>        "type": "ForLoopStart"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">79</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">80</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">81</div></div><pre>        "type": "Assign",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">82</div></div><pre>        "symbol": "a",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">83</div></div><pre>        "value_type": "Binary",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">84</div></div><pre>        "value": "a + 1"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">85</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">86</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">87</div></div><pre>        "type": "ForLoopEnd"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">88</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">89</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">90</div></div><pre>        "type": "ForLoopStart"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">91</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">92</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">93</div></div><pre>        "type": "Assign",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">94</div></div><pre>        "symbol": "a",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">95</div></div><pre>        "value_type": "Binary",</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">96</div></div><pre>        "value": "a + 1"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">97</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">98</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">99</div></div><pre>        "type": "ForLoopEnd"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">100</div></div><pre>    },</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">101</div></div><pre>    {</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">102</div></div><pre>        "type": "EndFor"</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">103</div></div><pre>    }</pre></div><div style="position: relative;"><div style="position: absolute; left: -30px;"><div style="left: 0px; width: 21px;" class="CodeMirror-linenumber CodeMirror-gutter-elt">104</div></div><pre>]</pre></div></div><div style="left: 179px; top: 308px; height: 14px;" class="CodeMirror-cursor">&nbsp;</div><div style="display: none;" class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 1464px;"></div><div style="height: 1464px;" class="CodeMirror-gutters"><div style="width: 29px;" class="CodeMirror-gutter CodeMirror-linenumbers"></div></div></div></div>
                </div>
            </div>
            <div class="row section">
            </div>
        </div>
        <script src="kirakira_javascript_files/jquery-2.js"></script>
        <script src="kirakira_javascript_files/bootstrap.js"></script>
        <script src="kirakira_javascript_files/codemirror.js"></script>
        <script src="kirakira_javascript_files/uglifyjs.js"></script>
        <script>
            String.prototype.splice = function(idx, rem, s) {
                var line = (this.slice(0, idx) + s + this.slice(idx + Math.abs(rem)));
                return line; 
            };

            function strip(string) {
                return string.replace(/^\s*(.*?)\s*$/, "$1");
            }

            function addQueue(obj) {
                queue.push(obj);
                return true;
            }

            var lines = [];
            var queue = [];
            var timerId = "";

            var $code = $("#code");
            var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
                lineNumbers: true,
                lineWrapping: true
            });

            var editorCompiled = CodeMirror.fromTextArea(document.getElementById("compiled"), {
                lineNumbers: true,
                lineWrapping: true
            });

            var editorData = CodeMirror.fromTextArea(document.getElementById("data"), {
                lineNumbers: true,
                lineWrapping: true
            });

            $("#sample1").on("click", function() {
                var initialCode = "";
                initialCode += "var a = \"A\";\n"; 
                initialCode += "\n";
                initialCode += "a = 1;\n"; 
                initialCode += "\n";
                initialCode += "if(a > 0) {\n";
                initialCode += "    a = a + 1;\n";
                initialCode += "} else {\n";
                initialCode += "    a = a - 1;\n";
                initialCode += "}\n";
                initialCode += "\n";
                initialCode += "for(var i = 0; i < 5; i++) {\n";
                initialCode += "    a = a + 1;\n";
                initialCode += "}\n";
                initialCode += "\n";
                initialCode += "\n";
                initialCode += "\n";
                initialCode += "\n";

                editor.setValue(initialCode);
            });


            $("#sample2").on("click", function() {
                var initialCode = "";
                initialCode += "var a = \"A\";\n"; 
                initialCode += "\n";
                initialCode += "a = 1;\n"; 
                initialCode += "\n";
                initialCode += "var b = a;\n";
                initialCode += "\n";
                initialCode += "var c = function(x) {\n";
                initialCode += "    var y = 0;\n";
                initialCode += "    return y * y;\n";
                initialCode += "};\n";
                initialCode += "\n";

                editor.setValue(initialCode);
            });

            function showLineEffect(index) {
                if(typeof index == "number") {
                    index = [index];
                }

                for(var i = 0, l = index.length; i <= l; i++) {
                    (function() {
                        var $pre = $(".CodeMirror-code pre:eq(" + index[i] + ")");

                        $pre.addClass("effected");
                        setTimeout(function() {
                            $pre.removeClass("effected");
                        }, 300);
                    })();
                }
            }

            function start() {
            }

            function stop() {
                clearInterval(timerId);
                timerId = null;
            }

            var insertFunctions = [];

            function assign(symbol, value, node) {
                if(value) {
                    switch(value.TYPE) {
                        case "String":
                        insertFunctions.push({ value: ";queue.push({ type: 'Assign', symbol: '" + symbol+ "', value_type: '" + value.TYPE  + "', value: '" + value.value + "' });", pos: node.end.endpos });
                        break;

                        case "Number":
                        insertFunctions.push({ value: ";queue.push({ type: 'Assign', symbol: '" + symbol + "', value_type: '" + value.TYPE  + "', value: " + value.value + " });", pos: node.end.endpos });
                        console.log(node.end.value);
                        break;

                        case "Binary":
                        var stream = UglifyJS.OutputStream({ beautify: true });
                        value.print(stream);
                        
                        insertFunctions.push({ value: ";queue.push({ type: 'Assign', symbol: '" + symbol + "', value_type: '" + value.TYPE  + "', value: '" + stream.toString()  + "' });", pos: node.end.endpos });
                        break;

                        case "SymbolRef":
                        insertFunctions.push({ value: ";queue.push({ type: 'Assign', symbol: '" + symbol + "', value_type: '" + value.TYPE  + "', value: '" + name + "' });", pos: node.end.endpos });
                        break;

                        case "Function":
                        insertFunctions.push({ value: ";queue.push({ type: 'Assign', symbol: '" + symbol + "', value_type: '" + value.TYPE + "'});", pos: node.end.endpos });
                        break;

                        // objectはpropertiesを持つので、それをうまく活用する
                        // prototyoeをどうやって表現するか
                        // object生成用のTypeを作成するひつようがあるか
                        case "Object":
                        insertFunctions.push({ value: ";queue.push({ type: 'Assign', symbol: '" + symbol + "', value_type: '" + value.TYPE + "'});", pos: node.end.endpos });
                        break;
                    }
                }
            }

            function parseNode(node) {
                console.log(node);
                switch(node.TYPE) {
                    case "Var":
                    if(node.hasOwnProperty("definitions")) {
                        for(var i = 0; i < node.definitions.length; i++) {
                            var varDef = node.definitions[i];
                            var name = varDef.name.name;
                            insertFunctions.push({ value: ";queue.push({ type: 'Var', symbol: '" + name +"' });", pos: node.end.endpos });
                            assign(name, varDef.value, varDef);
                        }
                    }
                    break;

                    case "Assign":
                    assign(node.left.name, node.right, node);
                    break;

                    case "ForIn":
                    if(node.hasOwnProperty("step")) {
                        var startLine = node.start.line - 1;
                        var endLine   = node.step.end.line - 1;
                    }
                    break;

                    case "For":
                    insertFunctions.push({ value: "queue.push({ type: 'For' });", pos: node.start.pos });
                    if (node.hasOwnProperty("init")) {
                        var init = node.init;
                    }

                    var hasCondition = false;
                    if (node.hasOwnProperty("condition")) {
                        var condition = node.condition;
                    }
                    

                    if (node.hasOwnProperty("body")) {
                        var body = node.body;
                        var addKakko = false;
                        if(node.body.TYPE == "BlockStatement") {
                        } else {
                            addKakko = true;
                            insertFunctions.push({ value: "{", pos: body.start.pos });
                        }

                        insertFunctions.push({ value: "queue.push({ type: 'ForLoopStart' });", pos: body.start.endpos });
                        parseNode(body);
                        insertFunctions.push({ value: "queue.push({ type: 'ForLoopEnd' });", pos: body.end.pos });

                        if(addKakko) {
                            insertFunctions.push({ value: "}", pos: body.end.endpos });
                        }
                    }
                    insertFunctions.push({ value: "queue.push({ type: 'EndFor' });", pos: node.end.endpos });
                    break;

                    case "If":
                    insertFunctions.push({ value: "queue.push({ type: 'If'});", pos: node.start.pos });
                    if(node.hasOwnProperty("condition")) {
                        var stream = UglifyJS.OutputStream({ beautify: true });
                        node.condition.print(stream);
                        insertFunctions.push({ value: "queue.push({ type: 'Condition', value: '" + stream.toString() + "' }) && ", pos: node.condition.start.pos });
                    }

                    if(node.hasOwnProperty("body")) {
                        insertFunctions.push({ value: "queue.push({ type: 'ConditionResult', value: 'TRUE' }); ", pos: node.body.start.endpos });
                        var body = node.body.body;
                        if(body instanceof Array) {
                            for(var i = 0; i < body.length; i++) {
                                parseNode(body[i]);
                            }
                        } else {
                            parseNode(body);
                        }
                    }

                    if(node.hasOwnProperty("alternative")) {
                        insertFunctions.push({ value: "queue.push({ type: 'ConditionResult', value: 'FALSE' }); ", pos: node.alternative.start.endpos });
                        var body = node.alternative.body;
                        if(body instanceof Array) {
                            for(var i = 0; i < body.length; i++) {
                                parseNode(body[i]);
                            }
                        } else {
                            parseNode(body);
                        }
                    }
                    insertFunctions.push({ value: "queue.push({ type: 'EndIf' });", pos: node.end.endpos });
                    break;

                    default:
                    if(node.hasOwnProperty("body")) {
                        if(node.body instanceof Array) {
                            for(var i = 0, il = node.body.length; i < il; i++) {
                                parseNode(node.body[i]);
                            }
                            } else {
                            parseNode(node.body);
                        }
                    }

                }
                
            }

            $("#execute").on("click", function() {
                if(timerId) {
                    return;
                }

                insertFunctions = [];

                var value = editor.getValue();
                var lines = value.split("\n");
                var ast = UglifyJS.parse(value);
                var stream = UglifyJS.OutputStream({});
                ast.print(stream);
                console.log(ast);
                console.log(stream.toString());

                for(var i = 0, il = ast.body.length; i < il; i++) {
                    parseNode(ast.body[i]);
                }
                console.log(insertFunctions);

                for(
                var i = 0, current_pos = 0, line_num = 0, line_length = lines[0].length + 1, offset = 0; 
                i < insertFunctions.length;
                i++) {
                    var insertFunction = insertFunctions[i];
                    while(insertFunction.pos > current_pos + line_length) {
                        current_pos += line_length; 
                        offset = 0;

                        line_num++;
                        line_length = lines[line_num].length + 1;
                    }
                    
                    var index = insertFunction.pos - current_pos;
                    lines[line_num] = lines[line_num].splice(index + offset, 0, insertFunction.value);

                    offset += insertFunction.value.length;
                }

                value = lines.join("\n");
                editorCompiled.setValue(value);

                queue = [];
                eval(value);
                console.log(queue);
                editorData.setValue(JSON.stringify(queue, null, 4));

                return;
                timerId = setInterval(function() {
                    if(queue.length == 0) {
                        clearInterval(timerId);
                        timerId = null;
                     } else {
                        showLineEffect(queue.shift());
                    }
                }, 250); 
            });

            $("#stop").on("click", function() {
                stop();
            });
        </script>
    

</body></html>